<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate from a model object — mrgsim • mrgsolve</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Simulate from a model object — mrgsim" />

<meta property="og:description" content="This function sets up the simulation run from data stored in the model
object as well as arguments passed in.  Note that there are several 
non-formal arguments to this function that can be used to customize 
the simulation run and it's output. Use mrgsim_df to 
return a data frame rather than mrgsims object." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mrgsolve</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.8.12.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/metrumresearchgroup/mrgsolve">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate from a model object</h1>
    <small class="dont-index">Source: <a href='https://github.com/metrumresearchgroup/mrgsolve/blob/master/R/mrgsolve.R'><code>R/mrgsolve.R</code></a></small>
    <div class="hidden name"><code>mrgsim.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function sets up the simulation run from data stored in the model
object as well as arguments passed in.  Note that there are several 
non-formal arguments to this function that can be used to customize 
the simulation run and it's output. Use <code>mrgsim_df</code> to 
return a data frame rather than <code>mrgsims</code> object.</p>
    
    </div>

    <pre class="usage"><span class='fu'>mrgsim</span>(<span class='no'>x</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>idata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>events</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>nid</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>...</span>)

<span class='fu'>mrgsim_df</span>(<span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>the model objects</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>NMTRAN-like data set (see <code><a href='data_set.html'>data_set</a></code>)</p></td>
    </tr>
    <tr>
      <th>idata</th>
      <td><p>a matrix or data frame of model parameters, 
one parameter per row (see <code><a href='idata_set.html'>idata_set</a></code>)</p></td>
    </tr>
    <tr>
      <th>events</th>
      <td><p>an event object</p></td>
    </tr>
    <tr>
      <th>nid</th>
      <td><p>integer number of individuals to simulate; only used if 
idata and data are missing</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>passed to <code><a href='update.html'>update</a></code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object of class <code><a href='mrgsims.html'>mrgsims</a></code></p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <ul>
<li><p>Both <code>data</code> and <code>idata</code> will be coreced to numeric matrix</p></li>
<li><p><code>carry.out</code> can be used to insert data columns into the output 
data set.  This is partially dependent on the nature of the data brought 
into the problem.</p></li>
<li><p>When using <code>data</code> and <code>idata</code> together, an error is 
generated if an  ID occurs in <code>data</code> but not <code>idata</code>.  
Also, when looking up data in <code>idata</code>, ID in <code>idata</code> is 
assumed to be uniquely keyed to ID in <code>data</code>.  No error is 
generated if ID is duplicated in <code>data</code>; parameters will be used 
from the first occurrence found in <code>idata</code>.</p></li>
<li><p><code>carry.out</code>: <code>idata</code> is assumed to be 
individual-level and variables that are carried from <code>idata</code> 
are repeated throughout the invidivual's simulated data.  Variables 
carried from <code>data</code> are carried via last-observation carry forward.  
<code>NA</code> is returned from observations that are inserted into 
simulated output that occur prior to the first record in <code>data</code>.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="additional-arguments"><a class="anchor" href="#additional-arguments"></a>Additional arguments</h2>

    
    <ul>
<li><p><code>Request</code> a vector of compartment or table names to take in 
simulated output; if this is specified, <code>request</code> is ignored</p></li>
<li><p><code>obsonly</code> omit records with <code>evid</code> != 0 from simulated 
output</p></li>
<li><p><code>obsaug</code> logical; when <code>TRUE</code> and a full data set is 
used, the simulated output is augmented with an observation at each 
time in <code><a href='stime.html'>stime</a></code>().  When using <code>obsaug</code>, a flag indicating 
augmented observations can be requested by including <code>a.u.g</code> in 
<code>carry.out</code></p></li>
<li><p><code>recsort</code>  Default value is 1.  Possible values are 1,2,3,4: 
1 and 2 put doses in a data set after padded observations at the same 
time; 3 and 4 put those doses before padded observations at the same 
time.  2 and 4 will put doses scheduled through <code>addl</code> after 
observations at the same time; 1 and 3 put doses scheduled through 
<code>addl</code> before observations at the same time. <code>recsort</code> will 
not change the order of your input data set if both doses and observations 
are given.</p></li>
<li><p><code>filbak</code> For each <code>ID</code>, carry the first record  <code>data</code> 
backward to start of the simulation</p></li>
<li><p><code>tad</code> logical; when <code>TRUE</code> a column is added to simulated 
output is added showing the time since the last dose.  Only data records 
with <code>evid == 1</code> will be considered doses for the purposes of 
<code>tad</code> calculation. The <code>tad</code> can be properly calculated with 
a dosing lag time in the model as long as the dosing lag time (specified 
in <code>$MAIN</code>)  is always  appropriate for any subsequent doses scheduled 
through <code>addl</code>.  This will always be true if the lag time doesn't 
change over time.  But it might (possibly) not hold if the lag time changes
prior to the last dose in the <code>addl</code> sequence.  This known limitation
shouldn't affect <code>tad</code> calculation in most common dosing lag time
implementations.</p></li>
<li><p><code>nocb</code> if <code>TRUE</code> (default), time-varying items in a data 
set will be implemented as next observation carried back; if <code>FALSE</code> 
time-varying items in a data set will be implemented as last observation 
carried forward.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='mrgsim_variants.html'>mrgsim_variants</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## example("mrgsim")</span>

<span class='no'>e</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='ev.html'>ev</a></span>(<span class='kw'>amt</span> <span class='kw'>=</span> <span class='fl'>1000</span>)
<span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mrgsolve</span><span class='kw ns'>:::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/mrgsolve/topics/house'>house</a></span>()
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='ev.html'>ev</a></span>(<span class='no'>e</span>) <span class='kw'>%&gt;%</span> <span class='fu'>mrgsim</span>()
<span class='fu'>plot</span>(<span class='no'>out</span>)</div><div class='img'><img src='mrgsim-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='ev.html'>ev</a></span>(<span class='no'>e</span>) <span class='kw'>%&gt;%</span> <span class='fu'>mrgsim</span>(<span class='kw'>end</span><span class='kw'>=</span><span class='fl'>22</span>)
<span class='no'>out</span></div><div class='output co'>#&gt; Model:  housemodel 
#&gt; Dim:    90 x 7 
#&gt; Time:   0 to 22 
#&gt; ID:     1 
#&gt;      ID time    GUT  CENT  RESP    DV    CP
#&gt; [1,]  1 0.00    0.0   0.0 50.00  0.00  0.00
#&gt; [2,]  1 0.00 1000.0   0.0 50.00  0.00  0.00
#&gt; [3,]  1 0.25  740.8 257.5 42.29 12.87 12.87
#&gt; [4,]  1 0.50  548.8 445.0 32.69 22.25 22.25
#&gt; [5,]  1 0.75  406.6 580.8 25.29 29.04 29.04
#&gt; [6,]  1 1.00  301.2 678.3 20.05 33.91 33.91
#&gt; [7,]  1 1.25  223.1 747.4 16.45 37.37 37.37
#&gt; [8,]  1 1.50  165.3 795.6 14.01 39.78 39.78</div><div class='input'>
<span class='fu'>data</span>(<span class='no'>exTheoph</span>)

<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='data_set.html'>data_set</a></span>(<span class='no'>exTheoph</span>) <span class='kw'>%&gt;%</span> <span class='fu'>mrgsim</span>()
<span class='no'>out</span></div><div class='output co'>#&gt; Model:  housemodel 
#&gt; Dim:    132 x 7 
#&gt; Time:   0 to 24.65 
#&gt; ID:     12 
#&gt;      ID time      GUT  CENT  RESP      DV      CP
#&gt; [1,]  1 0.00 4.020000 0.000 50.00 0.00000 0.00000
#&gt; [2,]  1 0.25 2.978089 1.035 49.95 0.04552 0.04552
#&gt; [3,]  1 0.57 2.028470 1.961 49.81 0.08624 0.08624
#&gt; [4,]  1 1.12 1.048417 2.875 49.57 0.12643 0.12643
#&gt; [5,]  1 2.02 0.356038 3.428 49.33 0.15072 0.15072
#&gt; [6,]  1 3.82 0.041060 3.439 49.25 0.15121 0.15121
#&gt; [7,]  1 5.10 0.008838 3.263 49.28 0.14348 0.14348
#&gt; [8,]  1 7.03 0.000872 2.980 49.34 0.13101 0.13101</div><div class='input'>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'>mrgsim</span>(<span class='kw'>data</span><span class='kw'>=</span><span class='no'>exTheoph</span>)

<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>mrgsim</span>(<span class='no'>mod</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>exTheoph</span>, <span class='kw'>obsonly</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>out</span></div><div class='output co'>#&gt; Model:  housemodel 
#&gt; Dim:    120 x 7 
#&gt; Time:   0.25 to 24.65 
#&gt; ID:     12 
#&gt;      ID time       GUT  CENT  RESP      DV      CP
#&gt; [1,]  1 0.25 2.978e+00 1.035 49.95 0.04552 0.04552
#&gt; [2,]  1 0.57 2.028e+00 1.961 49.81 0.08624 0.08624
#&gt; [3,]  1 1.12 1.048e+00 2.875 49.57 0.12643 0.12643
#&gt; [4,]  1 2.02 3.560e-01 3.428 49.33 0.15072 0.15072
#&gt; [5,]  1 3.82 4.106e-02 3.439 49.25 0.15121 0.15121
#&gt; [6,]  1 5.10 8.838e-03 3.263 49.28 0.14348 0.14348
#&gt; [7,]  1 7.03 8.720e-04 2.980 49.34 0.13101 0.13101
#&gt; [8,]  1 9.05 7.723e-05 2.703 49.40 0.11884 0.11884</div><div class='input'>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'>mrgsim</span>(<span class='kw'>data</span><span class='kw'>=</span><span class='no'>exTheoph</span>, <span class='kw'>obsaug</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>carry.out</span><span class='kw'>=</span><span class='st'>"a.u.g"</span>)
<span class='no'>out</span></div><div class='output co'>#&gt; Model:  housemodel 
#&gt; Dim:    5904 x 8 
#&gt; Time:   0 to 120 
#&gt; ID:     12 
#&gt;      ID time a.u.g   GUT  CENT  RESP      DV      CP
#&gt; [1,]  1 0.00     1 0.000 0.000 50.00 0.00000 0.00000
#&gt; [2,]  1 0.00     0 4.020 0.000 50.00 0.00000 0.00000
#&gt; [3,]  1 0.25     1 2.978 1.035 49.95 0.04552 0.04552
#&gt; [4,]  1 0.25     0 2.978 1.035 49.95 0.04552 0.04552
#&gt; [5,]  1 0.50     1 2.206 1.790 49.84 0.07870 0.07870
#&gt; [6,]  1 0.57     0 2.028 1.961 49.81 0.08624 0.08624
#&gt; [7,]  1 0.75     1 1.634 2.337 49.73 0.10274 0.10274
#&gt; [8,]  1 1.00     1 1.211 2.729 49.61 0.12001 0.12001</div><div class='input'>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='ev.html'>ev</a></span>(<span class='no'>e</span>) <span class='kw'>%&gt;%</span> <span class='fu'>mrgsim</span>(<span class='kw'>req</span><span class='kw'>=</span><span class='st'>"CENT"</span>)
<span class='no'>out</span></div><div class='output co'>#&gt; Model:  housemodel 
#&gt; Dim:    482 x 5 
#&gt; Time:   0 to 120 
#&gt; ID:     1 
#&gt;      ID time  CENT    DV    CP
#&gt; [1,]  1 0.00   0.0  0.00  0.00
#&gt; [2,]  1 0.00   0.0  0.00  0.00
#&gt; [3,]  1 0.25 257.5 12.87 12.87
#&gt; [4,]  1 0.50 445.0 22.25 22.25
#&gt; [5,]  1 0.75 580.8 29.04 29.04
#&gt; [6,]  1 1.00 678.3 33.91 33.91
#&gt; [7,]  1 1.25 747.4 37.37 37.37
#&gt; [8,]  1 1.50 795.6 39.78 39.78</div><div class='input'>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>mrgsim</span>(<span class='no'>mod</span>, <span class='kw'>Req</span><span class='kw'>=</span><span class='st'>"CP,RESP"</span>, <span class='kw'>events</span> <span class='kw'>=</span> <span class='no'>e</span>)
<span class='no'>out</span></div><div class='output co'>#&gt; Model:  housemodel 
#&gt; Dim:    482 x 4 
#&gt; Time:   0 to 120 
#&gt; ID:     1 
#&gt;      ID time  RESP    CP
#&gt; [1,]  1 0.00 50.00  0.00
#&gt; [2,]  1 0.00 50.00  0.00
#&gt; [3,]  1 0.25 42.29 12.87
#&gt; [4,]  1 0.50 32.69 22.25
#&gt; [5,]  1 0.75 25.29 29.04
#&gt; [6,]  1 1.00 20.05 33.91
#&gt; [7,]  1 1.25 16.45 37.37
#&gt; [8,]  1 1.50 14.01 39.78</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#additional-arguments">Additional arguments</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Kyle T Baron.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

