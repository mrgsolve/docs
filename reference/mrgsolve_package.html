<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="mrgsolve is an R package maintained under the auspices of
Metrum Research Group that facilitates simulation from
models based on systems of ordinary differential equations (ODE)
that are typically employed for understanding pharmacokinetics,
pharmacodynamics, and systems biology and pharmacology. mrgsolve
consists of computer code written in the R and C++ languages,
providing an interface to a C++ translation of the lsoda differential
equation solver. See aboutsolver for more information."><title>mrgsolve: Simulate from ODE-Based Models — mrgsolve-package • mrgsolve</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="mrgsolve: Simulate from ODE-Based Models — mrgsolve-package"><meta property="og:description" content="mrgsolve is an R package maintained under the auspices of
Metrum Research Group that facilitates simulation from
models based on systems of ordinary differential equations (ODE)
that are typically employed for understanding pharmacokinetics,
pharmacodynamics, and systems biology and pharmacology. mrgsolve
consists of computer code written in the R and C++ languages,
providing an interface to a C++ translation of the lsoda differential
equation solver. See aboutsolver for more information."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mrgsolve</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/mrgsolve.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/extra/dollar-pred.html">Models without compartments</a>
    <a class="dropdown-item" href="../articles/extra/events.html">Event objects</a>
    <a class="dropdown-item" href="../articles/extra/init.html">Set initial conditions</a>
    <a class="dropdown-item" href="../articles/extra/modeled-event-time.html">Modeled events</a>
    <a class="dropdown-item" href="../articles/extra/steady-state.html">Steady-state</a>
    <a class="dropdown-item" href="../articles/extra/time-after-dose.html">Time after dose</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/metrumresearchgroup/mrgsolve/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>mrgsolve: Simulate from ODE-Based Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/metrumresearchgroup/mrgsolve/blob/HEAD/R/package.R" class="external-link"><code>R/package.R</code></a></small>
      <div class="d-none name"><code>mrgsolve_package.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>mrgsolve is an R package maintained under the auspices of
Metrum Research Group that facilitates simulation from
models based on systems of ordinary differential equations (ODE)
that are typically employed for understanding pharmacokinetics,
pharmacodynamics, and systems biology and pharmacology. mrgsolve
consists of computer code written in the R and C++ languages,
providing an interface to a C++ translation of the lsoda differential
equation solver. See <a href="aboutsolver.html">aboutsolver</a> for more information.</p>
    </div>


    <div class="section level2">
    <h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a></h2>
    

<ul><li><p>Main mrgsolve resource page: <a href="https://mrgsolve.org" class="external-link">https://mrgsolve.org</a></p></li>
<li><p>User guide: <a href="https://mrgsolve.org/user_guide/" class="external-link">https://mrgsolve.org/user_guide/</a></p></li>
<li><p>Package documentation and vignettes: <a href="https://mrgsolve.org/docs/" class="external-link">https://mrgsolve.org/docs/</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="package-wide-options">Package-wide options<a class="anchor" aria-label="anchor" href="#package-wide-options"></a></h2>
    

<ul><li><p><code>mrgolve.project</code>: sets the default project director (<code><a href="mread.html">mread()</a></code>)</p></li>
<li><p><code>mrgsolve.soloc</code>: sets the default package build directory (<code><a href="mread.html">mread()</a></code>)</p></li>
<li><p><code>mrgsolve_mread_quiet</code>: don't print messages during <code><a href="mread.html">mread()</a></code></p></li>
<li><p><code>mrgsolve.update.strict</code>: this option has been deprecated; use the <code>strict</code>
argument to <code><a href="update.html">update()</a></code> instead</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Useful links:</p><ul><li><p><a href="https://github.com/metrumresearchgroup/mrgsolve" class="external-link">https://github.com/metrumresearchgroup/mrgsolve</a></p></li>
<li><p>Report bugs at <a href="https://github.com/metrumresearchgroup/mrgsolve/issues" class="external-link">https://github.com/metrumresearchgroup/mrgsolve/issues</a></p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><strong>Maintainer</strong>: Kyle T Baron <a href="mailto:kyleb@metrumrg.com">kyleb@metrumrg.com</a> (<a href="https://orcid.org/0000-0001-7252-5656" class="external-link">ORCID</a>)</p>
<p>Other contributors:</p><ul><li><p>Bill Gillespie [contributor]</p></li>
<li><p>Charles Margossian [contributor]</p></li>
<li><p>Devin Pastoor [contributor]</p></li>
<li><p>Bill Denney (<a href="https://orcid.org/0000-0002-5759-428X" class="external-link">ORCID</a>) [contributor]</p></li>
<li><p>Dilawar Singh [contributor]</p></li>
<li><p>Felicien Le Louedec (<a href="https://orcid.org/0000-0003-3699-2729" class="external-link">ORCID</a>) [contributor]</p></li>
<li><p>Timothy Waterhouse (<a href="https://orcid.org/0000-0002-0954-9660" class="external-link">ORCID</a>) [contributor]</p></li>
<li><p>Kyle Meyer [contributor]</p></li>
<li><p>Metrum Research Group [copyright holder]</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## example("mrgsolve")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">mrgsolve</span><span class="fu">::</span><span class="fu"><a href="house.html">house</a></span><span class="op">(</span>delta<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>  <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="param.html">param</a></span><span class="op">(</span>CL<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">events</span> <span class="op">&lt;-</span>  <span class="fu"><a href="ev.html">ev</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">1000</span>, cmt<span class="op">=</span><span class="fl">1</span>, addl<span class="op">=</span><span class="fl">5</span>, ii<span class="op">=</span><span class="fl">24</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">events</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Events:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time  amt ii addl cmt evid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    0 1000 24    5   1    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --------------  source: housemodel.cpp  --------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   project: /private/var/fol...solve/project</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   shared object: mrgsolve </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time:          start: 0 end: 120 delta: 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  add: &lt;none&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   compartments:  GUT CENT RESP [3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   parameters:    CL VC KA F1 D1 WTCL WTVC SEXCL SEXVC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  KIN KOUT IC50 WT SEX [14]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   captures:      DV CP [2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   omega:         4x4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sigma:         1x1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   solver:        atol: 1e-08 rtol: 1e-08 maxsteps: 20k</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="see.html">see</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model file:  housemodel.cpp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $PROB </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # `mrgsolve` housemodel</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> This model is compiled with `mrgsolve`.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   - Author: Metrum Research Group, LLC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   - Description: Generic indirect response PK/PD model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   - Covariates: Weight, female sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   - Random effects: CL, VC, KA, KOUT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   - Error model: exponential</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $PLUGIN base</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $PARAM @annotated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CL   : 1    : Clearance  (L/hr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> VC   : 20   : Volume of distribution (L)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KA   : 1.2  : Absorption rate constant (1/hr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F1   : 1.0  : Bioavailability fraction (.)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D1   : 2.0  : Infusion duration (hr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WTCL : 0.75 : Exponent WT on CL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WTVC : 1.00 : Exponent WT on VC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEXCL: 0.7  : Prop cov effect on CL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEXVC: 0.85 : Prop cov effect on VC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KIN  : 100  : Resp prod rate constant (1/hr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KOUT : 2    : Resp elim rate constant (1/hr)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IC50 : 10   : Conc giving 50% max resp (ng/ml)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $PARAM @annotated @covariates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WT   : 70   : Weight (kg)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SEX  :  0   : Covariate female sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $CMT @annotated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GUT  : Dosing compartment (mg)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CENT : Central compartment (mg)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RESP : Response (unitless)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $OMEGA @labels ECL EVC EKA EKOUT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0 0 0 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $SIGMA @labels EXPO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $SET end=120, delta=0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $GLOBAL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #define CP (CENT/VCi)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #define INH (CP/(IC50+CP))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> typedef double localdouble;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $MAIN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F_GUT = F1;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D_CENT = D1;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> double CLi   = exp(log(CL)   + WTCL*log(WT/70) + log(SEXCL)*SEX + ECL);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> double VCi   = exp(log(VC)   + WTVC*log(WT/70) + log(SEXVC)*SEX + EVC);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> double KAi   = exp(log(KA)   + EKA);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> double KOUTi = exp(log(KOUT) + EKOUT);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RESP_0 = KIN/KOUTi;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ODE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dxdt_GUT = -KAi*GUT;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dxdt_CENT = KAi*GUT - (CLi/VCi)*CENT;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dxdt_RESP = KIN*(1-INH) - KOUTi*RESP;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $TABLE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> double DV = CP*exp(EXPO);</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $CAPTURE @annotated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DV: Dependent variable (ng/ml)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CP: Plasma concentration (ng/ml)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="stime.html">stime</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="param.html">param</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Model parameters (N=14):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  name value . name  value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  CL   0.5   | SEX   0    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  D1   2     | SEXCL 0.7  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  F1   1     | SEXVC 0.85 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  IC50 10    | VC    20   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  KA   1.2   | WT    70   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  KIN  100   | WTCL  0.75 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  KOUT 2     | WTVC  1    </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="init.html">init</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Model initial conditions (N=3):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  name       value . name       value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  CENT (2)   0     | RESP (3)   50   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  GUT (1)    0     | . ...      .    </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="va">mod</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="ev.html">ev</a></span><span class="op">(</span><span class="va">events</span><span class="op">)</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="mrgsim.html">mrgsim</a></span><span class="op">(</span>end<span class="op">=</span><span class="fl">168</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ID time       GUT     CENT     RESP        DV        CP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1  0.0    0.0000   0.0000 50.00000  0.000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1  0.0 1000.0000   0.0000 50.00000  0.000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1  0.1  886.9204 112.9355 48.03655  5.646775  5.646775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1  0.2  786.6279 212.8183 44.31899 10.640917 10.640917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1  0.3  697.6763 301.1252 40.24379 15.056258 15.056258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1  0.4  618.7834 379.1657 36.29753 18.958286 18.958286</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ID  time          GUT     CENT     RESP       DV       CP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1677  1 167.5 1.218838e-22 671.4739 11.36504 33.57369 33.57369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1678  1 167.6 1.077788e-22 669.7973 11.38701 33.48987 33.48987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1679  1 167.7 9.538423e-23 668.1249 11.40901 33.40625 33.40625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1680  1 167.8 8.441723e-23 666.4567 11.43104 33.32283 33.32283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1681  1 167.9 7.466555e-23 664.7926 11.45310 33.23963 33.23963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1682  1 168.0 6.610146e-23 663.1327 11.47519 33.15664 33.15664</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1682    7</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">GUT</span><span class="op">+</span><span class="va">CP</span><span class="op">~</span><span class="va">.</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mrgsolve_package-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">t72</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sims</span>, <span class="va">time</span><span class="op">==</span><span class="fl">72</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">t72</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'data.frame':	1 obs. of  7 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ ID  : num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ time: num 72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ GUT : num 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ CENT: num 1037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ RESP: num 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ DV  : num 51.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ CP  : num 51.8</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">idata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, CL<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,VC<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="va">mod</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="ev.html">ev</a></span><span class="op">(</span><span class="va">events</span><span class="op">)</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="mrgsim.html">mrgsim</a></span><span class="op">(</span>end<span class="op">=</span><span class="fl">168</span>, idata<span class="op">=</span><span class="va">idata</span>, req<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mrgsolve_package-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="va">mod</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="ev.html">ev</a></span><span class="op">(</span><span class="va">events</span><span class="op">)</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="mrgsim.html">mrgsim</a></span><span class="op">(</span>carry_out<span class="op">=</span><span class="st">"amt,evid,cmt,CL"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ID time evid  amt cmt       GUT     CENT     RESP        DV        CP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1  0.0    0    0   0    0.0000   0.0000 50.00000  0.000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  1  0.0    1 1000   1 1000.0000   0.0000 50.00000  0.000000  0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  1  0.1    0    0   0  886.9204 112.9355 48.03655  5.646775  5.646775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  1  0.2    0    0   0  786.6279 212.8183 44.31899 10.640917 10.640917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  1  0.3    0    0   0  697.6763 301.1252 40.24379 15.056258 15.056258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  1  0.4    0    0   0  618.7834 379.1657 36.29753 18.958286 18.958286</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ev1</span> <span class="op">&lt;-</span> <span class="fu"><a href="ev.html">ev</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">500</span>, cmt<span class="op">=</span><span class="fl">2</span>,rate<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ev2</span> <span class="op">&lt;-</span> <span class="fu"><a href="ev.html">ev</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">100</span>, cmt<span class="op">=</span><span class="fl">1</span>, time<span class="op">=</span><span class="fl">54</span>, ii<span class="op">=</span><span class="fl">8</span>, addl<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ev1</span><span class="op">+</span><span class="va">ev2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">events</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Events:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   time amt rate cmt evid ii addl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    0 500   10   2    1  0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   54 100    0   1    1  8   10</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="va">mod</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="ev.html">ev</a></span><span class="op">(</span><span class="va">events</span><span class="op">)</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="mrgsim.html">mrgsim</a></span><span class="op">(</span>end<span class="op">=</span><span class="fl">180</span>, req<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mrgsolve_package-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## "Condensed" data set</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">extran1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">extran1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ID  amt cmt time addl ii rate evid</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  1 1000   1    0    3 24    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2 1000   2    0    0  0   20    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  3 1000   1    0    0  0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  3  500   1   24    0  0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  3  500   1   48    0  0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  3 1000   1   72    0  0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  4 2000   2    0    2 48  100    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  5 1000   1    0    0  0    0    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  5 5000   1   24    0  0   60    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="va">mod</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="data_set.html">data_set</a></span><span class="op">(</span><span class="va">extran1</span><span class="op">)</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="mrgsim.html">mrgsim</a></span><span class="op">(</span>end<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span>,<span class="va">CP</span><span class="op">~</span><span class="va">time</span><span class="op">|</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mrgsolve_package-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## idata</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">exidata</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> </span></span>
<span class="r-in"><span>  <span class="va">mod</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="ev.html">ev</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">1000</span>, cmt<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="idata_set.html">idata_set</a></span><span class="op">(</span><span class="va">exidata</span><span class="op">)</span> <span class="op"><a href="zchain.html">%&gt;%</a></span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="mrgsim.html">mrgsim</a></span><span class="op">(</span>end<span class="op">=</span><span class="fl">72</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">CP</span><span class="op">~</span><span class="va">.</span>, as<span class="op">=</span><span class="st">"log10"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In subset.data.frame(as.data.frame(x), ...) :</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>  extra argument ‘as’ will be disregarded</span>
<span class="r-plt img"><img src="mrgsolve_package-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Internal model library</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mread.html">mread</a></span><span class="op">(</span><span class="st">"irm1"</span>, <span class="fu"><a href="modlib.html">modlib</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">mod</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="ev.html">ev</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">300</span>, ii<span class="op">=</span><span class="fl">12</span>, addl<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="va">mrgsim</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Kyle T Baron.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

