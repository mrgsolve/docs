<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Read a model specification file — mread • mrgsolve</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read a model specification file — mread"><meta name="description" content="mread() reads and parses the mrgsolve model specification file,
builds the model, and returns a model object for simulation.
mread_cache() does the same, but caches the compilation result for
later use. mread_file() can be used for convenience, taking the model
file name as the first argument."><meta property="og:description" content="mread() reads and parses the mrgsolve model specification file,
builds the model, and returns a model object for simulation.
mread_cache() does the same, but caches the compilation result for
later use. mread_file() can be used for convenience, taking the model
file name as the first argument."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mrgsolve</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/mrgsolve.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/extra/dollar-pred.html">Models without compartments</a></li>
    <li><a class="dropdown-item" href="../articles/extra/events.html">Event objects</a></li>
    <li><a class="dropdown-item" href="../articles/extra/init.html">Set initial conditions</a></li>
    <li><a class="dropdown-item" href="../articles/extra/modeled-event-time.html">Modeled events</a></li>
    <li><a class="dropdown-item" href="../articles/extra/steady-state.html">Steady-state</a></li>
    <li><a class="dropdown-item" href="../articles/extra/time-after-dose.html">Time after dose</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/metrumresearchgroup/mrgsolve/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Read a model specification file</h1>
      <small class="dont-index">Source: <a href="https://github.com/metrumresearchgroup/mrgsolve/blob/HEAD/R/mread.R" class="external-link"><code>R/mread.R</code></a></small>
      <div class="d-none name"><code>mread.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>mread()</code> reads and parses the mrgsolve model specification file,
builds the model, and returns a model object for simulation.
<code>mread_cache()</code> does the same, but caches the compilation result for
later use. <code>mread_file()</code> can be used for convenience, taking the model
file name as the first argument.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mread</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  project <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mrgsolve.project"</span>, <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  code <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  udll <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ignore.stdout <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  raw <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  compile <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  audit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mrgsolve_mread_quiet"</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  check.bounds <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  soloc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mrgsolve.soloc"</span>, <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  capture <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  preclean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  recover <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mread_cache</span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  project <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mrgsolve.project"</span>, <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">model</span>, <span class="st">".cpp"</span><span class="op">)</span>,</span>
<span>  code <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  soloc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mrgsolve.soloc"</span>, <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  preclean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  capture <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mread_file</span><span class="op">(</span><span class="va">file</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>model name.</p></dd>


<dt id="arg-project">project<a class="anchor" aria-label="anchor" href="#arg-project"></a></dt>
<dd><p>location of the model specification file an any
headers to be included; see also the discussion about model; this argument
can be set via <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code>.
library under details as well as the <code><a href="modlib.html">modlib()</a></code> help topic.</p></dd>


<dt id="arg-code">code<a class="anchor" aria-label="anchor" href="#arg-code"></a></dt>
<dd><p>a character string with model specification code to be
used instead of a model file.</p></dd>


<dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>the full file name (with extension, but without path)
where the model is specified.</p></dd>


<dt id="arg-udll">udll<a class="anchor" aria-label="anchor" href="#arg-udll"></a></dt>
<dd><p>use unique name for shared object.</p></dd>


<dt id="arg-ignore-stdout">ignore.stdout<a class="anchor" aria-label="anchor" href="#arg-ignore-stdout"></a></dt>
<dd><p>passed to system call when compiling the model; set this
to <code>FALSE</code> to print output to the R console.</p></dd>


<dt id="arg-raw">raw<a class="anchor" aria-label="anchor" href="#arg-raw"></a></dt>
<dd><p>if <code>TRUE</code>, return model content as a list, bypassing the compile
step; this argument is typically used for debugging problems with the
model build.</p></dd>


<dt id="arg-compile">compile<a class="anchor" aria-label="anchor" href="#arg-compile"></a></dt>
<dd><p>logical; if <code>TRUE</code>, the model will be built.</p></dd>


<dt id="arg-audit">audit<a class="anchor" aria-label="anchor" href="#arg-audit"></a></dt>
<dd><p>check the model specification file for errors.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>don't print messages from mrgsolve when compiling.</p></dd>


<dt id="arg-check-bounds">check.bounds<a class="anchor" aria-label="anchor" href="#arg-check-bounds"></a></dt>
<dd><p>check boundaries of parameter list.</p></dd>


<dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>logical; if <code>TRUE</code>, print warning messages that may arise while
building the model.</p></dd>


<dt id="arg-soloc">soloc<a class="anchor" aria-label="anchor" href="#arg-soloc"></a></dt>
<dd><p>the directory location where the model shared object is built
and stored; see details; this argument can be set via <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code>;
if the directory does not exist, <code>mread()</code> will attempt to create it.</p></dd>


<dt id="arg-capture">capture<a class="anchor" aria-label="anchor" href="#arg-capture"></a></dt>
<dd><p>a character vector or comma-separated string of additional
model variables to capture; these variables will be added to the capture
list for the current call to <code>mread()</code> only.</p></dd>


<dt id="arg-preclean">preclean<a class="anchor" aria-label="anchor" href="#arg-preclean"></a></dt>
<dd><p>logical; if <code>TRUE</code>, compilation artifacts are
cleaned up first.</p></dd>


<dt id="arg-recover">recover<a class="anchor" aria-label="anchor" href="#arg-recover"></a></dt>
<dd><p>if <code>TRUE</code>, a list of build will be returned in case
the model shared object fails to compile; use this option to and
the returned object to collect information assist in debugging.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>passed to <code><a href="update.html">update()</a></code>; also arguments passed
to <code>mread()</code> from <code>mread_cache()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>model</code> argument is required.  For typical use,
the <code>file</code> argument is omitted and the value
for <code>file</code> is generated from the value for <code>model</code>.
To determine the source file name, mrgsolve will look for
a file extension in <code>model</code>.  A file extension is
assumed when it finds a period followed by one to three alpha-numeric
characters at the end of the string (e.g. <code>mymodel.txt</code> but not
<code>my.model</code>).  If no file extension is found, the extension <code>.cpp</code>
is assumed (e.g. <code>file</code> is <code>&lt;model-name&gt;.cpp</code>).  If a file
extension is found, <code>file</code> is <code>&lt;model-name&gt;</code>.</p>
<p>Best practice is to avoid using <code>.</code> in <code>model</code> unless
you are using <code>model</code> to point to the model specification
file name. Otherwise, use <code>mread_file()</code>.</p>
<p>Use the <code>soloc</code> argument to specify a directory location for building
the model.  This is the location where the model shared object will be
stored on disk.  The default is a temporary directory, so compilation
artifacts are lost when R restarts when the default is used.  Changing
<code>soloc</code> to a persistent directory location will preserve those
artifacts across R restarts. Also, if simulation from a single model is
being done in separate processes on separate compute nodes, it might be
necessary to store these compilation artifacts in a local directory
to make them accessible to the different nodes. If the <code>soloc</code>
directory does not exist, <code>mread()</code> will attempt to create it.</p>
<p>Similarly, using <code>mread_cache()</code> will cache results in the temporary
directory and the cache cannot be accessed after the R process is
restarted.</p>
    </div>
    <div class="section level2">
    <h2 id="model-library">Model Library<a class="anchor" aria-label="anchor" href="#model-library"></a></h2>



<p>mrgsolve comes bundled with several pre-coded PK, PK/PD, and
other systems models that are accessible via the <code>mread()</code> interface.</p>
<p>Models available in the library include:</p><ul><li><p>PK models: <code>pk1cmt</code>, <code>pk2cmt</code>, <code>pk3cmt</code>, <code>pk1</code>, <code>pk2</code>, <code>popex</code>, <code>tmdd</code></p></li>
<li><p>PKPD models: <code>irm1</code>, <code>irm2</code>, <code>irm3</code>, <code>irm4</code>, <code>emax</code>, <code>effect</code></p></li>
<li><p>Other models: <code>viral1</code>, <code>viral2</code></p></li>
</ul><p>When the library model is accessed, mrgsolve will compile and load
the model as you would for any other model.  It is only necessary to
reference the correct model name and point the <code>project</code> argument
to the mrgsolve model library location via <code><a href="modlib.html">modlib()</a></code>.</p>
<p>For more details, see <a href="modlib_pk.html">modlib_pk</a>, <a href="modlib_pkpd.html">modlib_pkpd</a>, <a href="modlib_tmdd.html">modlib_tmdd</a>,
<a href="modlib_viral.html">modlib_viral</a>, and <a href="modlib_details.html">modlib_details</a> for more information about the state
variables and parameters in each model.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mcode.html">mcode()</a></code>, <code><a href="mcode.html">mcode_cache()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">code</span> <span class="op">&lt;-</span> <span class="st">'</span></span></span>
<span class="r-in"><span><span class="st">$PARAM CL = 1, VC = 5</span></span></span>
<span class="r-in"><span><span class="st">$CMT CENT</span></span></span>
<span class="r-in"><span><span class="st">$ODE dxdt_CENT = -(CL/VC)*CENT;</span></span></span>
<span class="r-in"><span><span class="st">'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mcode.html">mcode</a></span><span class="op">(</span><span class="st">"ex_mread"</span>, <span class="va">code</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="init.html">init</a></span><span class="op">(</span>CENT<span class="op">=</span><span class="fl">1000</span><span class="op">)</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="mrgsim.html">mrgsim</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="zchain.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">mread</span><span class="op">(</span><span class="st">"irm3"</span>, <span class="fu"><a href="modlib.html">modlib</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># if the model is in the file mymodel.cpp</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">mread</span><span class="op">(</span><span class="st">"mymodel"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># if the model is in the file mymodel.txt</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">mread</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"mymodel.txt"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">or</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">mread_file</span><span class="op">(</span><span class="st">"mymodel.txt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kyle T Baron.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

